<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_finish.xml" version="5.0" xml:id="cha-upgrade-finish">
 <title>Completamento dell&apos;upgrade</title>
 <info>
  <abstract>
   <para>
    Dopo l&apos;upgrade è necessario eseguire alcune attività aggiuntive. Il seguente capitolo offre indicazioni su questa procedura.
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <sect1 xml:id="sec-upgrade-finish-old-packages">
  <title>Controllo dei pacchetti precedenti</title>
  <para>
   Utilizzare <command>zypper packages</command> per verificare la presenza di pacchetti orfani e non necessari.
  </para>
  <para>
   I pacchetti orfani non sono più disponibili in nessuno dei repository dei pacchetti configurati. Non è più possibile aggiornarli e non vengono più supportati.
  </para>
  <para>
   Per un elenco dei pacchetti orfani, eseguire il comando:
  </para>
<screen><prompt>&gt; </prompt><command>zypper packages --orphaned</command></screen>
  <para>
   I pacchetti non necessari sono dipendenze di pacchetti installati esplicitamente dall&apos;utente o implicitamente nell&apos;ambito di un modello o di un prodotto e successivamente rimossi. Generalmente, anche questi ultimi non sono più necessari e dovrebbero essere rimossi.
  </para>
  <para>
   Per un elenco dei pacchetti non necessari, eseguire il comando:
  </para>
<screen><prompt>&gt; </prompt><command>zypper packages --unneeded</command></screen>
  <tip>
   <para>
    Per evitare pacchetti non necessari, utilizzare <command>zypper rm</command> con l’opzione <option>--clean-deps</option> o YaST, abilitando <menuchoice>
     <guimenu>Opzioni</guimenu><guimenu>Clean up when deleting packages (Esegui pulizia durante l&apos;eliminazione dei pacchetti)</guimenu></menuchoice>.
   </para>
  </tip>
  <para>
   È possibile combinare entrambi gli elenchi in un unico elenco:
  </para>
<screen><prompt>&gt; </prompt><command>zypper packages --orphaned --unneeded</command></screen>
  <para>
   Utilizzare tali elenchi per determinare i pacchetti ancora necessari e quelli che è possibile rimuovere in modo sicuro.
  </para>
  <warning>
   <title>non rimuovere i pacchetti necessari</title>
   <para>
    Se i pacchetti vengono rinominati o rimossi da un modello o da un prodotto, è possibile che <command>zypper</command> non li consideri più esplicitamente installati e li contrassegni come non necessari, anche sono ancora importanti per l&apos;installazione.
   </para>
   <para>
    Esamina con attenzione l&apos;elenco dei pacchetti in corso di rimozione.
   </para>
  </warning>
  <para>
   Per rimuovere tutti i pacchetti orfani e non necessari con un singolo comando, eseguire:
  </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>zypper rm $(zypper --no-refresh packages --orphaned --unneeded | gawk '{print $5}' | tail -n +5)</command></screen>
  <para>
   Per escludere un singolo pacchetto o modello dalla disinstallazione:
  </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>zypper rm $(zypper --no-refresh packages --orphaned --unneeded | gawk '{print $5}' | tail -n +5 | grep -v <replaceable>PACKAGE_TO_EXCLUDE</replaceable>)</command></screen>
  <para>
   Per escludere più pacchetti definiti in un file di testo, separati da un carattere di ritorno a capo:
  </para>
  <screen><prompt>&gt; </prompt><command>sudo</command> <command>zypper rm $(zypper --no-refresh packages --orphaned --unneeded | gawk '{print $5}' | tail -n +5 | grep -v -f <replaceable>/PACKAGES/TO/KEEP.txt</replaceable>)</command></screen>
 </sect1>
 <sect1 xml:id="sec-uggrade-finish-config-files">
  <title>Revisione dei file di configurazione</title>
  <para>
   Verificare l&apos;eventuale presenza dei file <filename>*.rpmnew</filename> e <filename>*.rpmsave</filename>. Un upgrade, quando include modifiche a un file di configurazione predefinito che è stato modificato dopo l&apos;installazione del pacchetto, invece di sovrascrivere il file crea uno di questi tipi di file. Mentre il file <filename>*.rpmnew</filename> contiene la nuova configurazione predefinita e non altera il file modificato, il file <filename>*.rpmsave</filename> è una copia della configurazione modificata sostituita dal nuovo file predefinito.
  </para>
  <para>
   Se si trovano questi file, esaminarne il contenuto e unire le modifiche desiderate. Non è necessario cercare nell&apos;intero file system, ma solo nella directory <filename>/etc</filename>. Utilizzare il seguente comando:
  </para>
<screen><prompt>&gt; </prompt><command>find /etc/ -name "*.rpmnew" -o -name "*.rpmsave"</command></screen>
 </sect1>

 
 <sect1 xml:id="sec-upgrade-finish-python3">
  <title>Abilitazione del modulo <literal>Python 3</literal></title>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 utilizza Python 3.6 per impostazione predefinita. Python 3.9 è stato aggiunto in <phrase role="productname"><phrase os="sles">SLES</phrase></phrase> 15 SP3 come alternativa più recente. Questa versione non è più supportata a partire da <phrase role="productname"><phrase os="sles">SLES</phrase></phrase> 15 SP4. Sono invece disponibili le versioni recenti di Python con importanti aggiornamenti e correzioni della sicurezza nel modulo <literal>Python 3</literal>.
  </para>
  <para>
   Se è stato installato 3.9 in <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 SP3, abilitare il modulo <literal>Python 3</literal> con:
  </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>SUSEConnect -p sle-module-python3/15.6/<replaceable>x86_64</replaceable></command>&#x002E;</screen>
  <para>
   In alternativa, è possibile tornare alla versione Python predefinita rimuovendo la versione 3.9 con <command>zypper remove -u python39</command>.
  </para>
 </sect1>

 <sect1 xml:id="sec-upgrade-finish-xfs4">
  <title>Riformattazione dei dispostivi XFS v4</title>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> supporta il <quote>formato su disco</quote> (v5) del file system XFS. I principali vantaggi di questo formato sono i codici di controllo di tutti i metadati XFS, il supporto per il tipo di file e per un numero maggiore di elenchi di controllo dell&apos;accesso per un file.
  </para>
  <para>
   Tenere presente che questo formato non è supportato da kernel di SUSE Linux Enterprise precedenti alla versione 3.12, pacchetti <literal>xfsprogs</literal> precedenti alla versione 3.2.0 e versioni GRUB 2 rilasciate prima di SUSE Linux Enterprise 12.
  </para>
  <important>
   <title>il formato V4 è obsoleto</title>
   <para>
    XFS rende obsoleti i file system in formato V4. Questo formato di file system è stato creato dal comando:
   </para>
<screen><prompt>&gt; </prompt><command>sudo</command> mkfs.xfs -m crc=0 <replaceable>DEVICE</replaceable></screen>
   <para>
    Il formato veniva utilizzato in SLE 11 e nelle release precedenti e attualmente crea un messaggio di avviso da <command>dmesg</command>:
   </para>
<screen>Deprecated V4 format (crc=0) will not be supported after September 2030</screen>
   <para>
    Se viene visualizzato tale messaggio nell&apos;output del comando <command>dmesg</command>, si consiglia di aggiornare il file system al formato V5:
   </para>
   <procedure>
    <step>
     <para>
      Eseguire il backup dei dati in un altro dispositivo.
     </para>
    </step>
    <step>
     <para>
      Creare il file system sul dispositivo.
     </para>
<screen><prompt>&gt; </prompt><command>sudo</command> mkfs.xfs -m crc=1 <replaceable>DEVICE</replaceable></screen>
    </step>
    <step>
     <para>
      Ripristinare i dati del backup sul dispositivo aggiornato.
     </para>
    </step>
   </procedure>
  </important>
 </sect1>
</chapter>
