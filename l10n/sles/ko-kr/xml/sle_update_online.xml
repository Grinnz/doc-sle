<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_online.xml" version="5.0" xml:id="cha-upgrade-online">
 <title os="sles;sled">온라인 업그레이드</title>
 
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
  <abstract>
   <para os="sles;sled">
    SUSE는 실행 중인 시스템을 새로운 서비스 팩으로 업그레이드하기 위한 직관적인 그래픽 및 간단한 명령 줄 도구를 제공합니다. 서비스 팩의 <quote>롤백</quote> 등도 모두 지원합니다. 이 장에서는 이러한 도구를 사용하여 서비스 팩 업그레이드를 수행하는 방법에 관한 단계별 지침을 제공합니다.
   </para>

   
  </abstract>
 </info>
 <sect1 xml:id="sec-upgrade-online-conceptual-overview">
  <title>개념 개요</title>

  <para os="sles;sled">
   SUSE는 정기적으로 SUSE Linux Enterprise 제품군을 위한 새로운 서비스 팩을 공개합니다. 고객이 쉽게 새로운 서비스 팩으로 마이그레이트하고 작동 중지 시간을 최소화할 수 있도록 SUSE는 시스템 실행 중에 온라인 마이그레이션을 지원합니다.
  </para>

  

  <para os="sles;sled">
   SLE 12부터 YaST Wagon이 YaST 마이그레이션(GUI)과 Zypper 마이그레이션(명령 줄)으로 대체되었습니다. 이는 다음과 같은 장점이 있습니다.
  </para>

  

  

  <itemizedlist>
   <listitem>
    <para>
     첫 번째 RPM을 업데이트할 때까지 시스템이 항상 정의된 상태를 유지.
    </para>
   </listitem>
   <listitem>
    <para>
     첫 번째 RPM을 업데이트할 때까지는 취소 가능.
    </para>
   </listitem>
   <listitem>
    <para>
     오류 발생 시 간단하게 복구.
    </para>
   </listitem>
   <listitem>
    <para>
     시스템 도구를 통해 <quote>롤백</quote>을 수행할 수 있어 백업이나 복원이 필요하지 않음.
    </para>
   </listitem>
   <listitem>
    <para>
     모든 활성 리포지토리 사용.
    </para>
   </listitem>
   <listitem os="sles;sled">
    <para>
     서비스 팩을 건너뛰는 기능
    </para>
   </listitem>
  </itemizedlist>

  <warning os="sles;sled">
   <title>주 릴리스에 지원되지 않는 온라인 마이그레이션</title>
   <para>
    온라인 마이그레이션은 서비스 팩 간 마이그레이션에<emphasis>만</emphasis> 지원됩니다. 온라인 마이그레이션은 새로운 주 릴리스로의 업그레이드에는 <emphasis>지원되지 않습니다</emphasis>. 자세한 내용은 <xref linkend="cha-upgrade-paths"/>을 참조하십시오.
   </para>
   <para>
    새로운 주 릴리스로의 업그레이드에는 오프라인 마이그레이션을 사용하십시오. 자세한 내용은 <xref linkend="cha-upgrade-offline"/>를 참조하십시오.
   </para>
  </warning>

  <important os="sles;sled">
   <title>SUSE Manager 클라이언트 업그레이드</title>
   <para>
    업그레이드할 시스템이 SUSE Manager 클라이언트인 경우 YaST 온라인 마이그레이션 또는 <command>zypper migration</command>으로 업그레이드할 수 없습니다. 대신, <citetitle>Client Migration</citetitle> 절차를 사용하십시오. <link xlink:href="https://documentation.suse.com/suma/">
    <citetitle>SUSE Manager Upgrade Guide</citetitle></link>에 설명되어 있습니다.
   </para>
  </important>
 </sect1>
 <sect1 os="sles;sled" xml:id="sec-upgrade-online-workflow">
  <title>서비스 팩 마이그레이션 워크플로</title>

  <para>
   서비스 팩 마이그레이션은 YaST, <command>zypper</command>, 또는 AutoYaST로 실행할 수 있습니다.
  </para>

  <para>
   서비스 팩 마이그레이션을 시작하려면 먼저 SUSE Customer Center나 로컬 RMT 서버에 시스템을 등록해야 합니다. SUSE Manager를 사용할 수도 있습니다.
  </para>

  <para>
   방법에 관계없이 서비스 팩 마이그레이션은 다음 단계로 구성됩니다.
  </para>

  <orderedlist>
   <listitem>
    <para>
     등록된 시스템에서 가능한 마이그레이션 대상을 찾습니다.
    </para>
   </listitem>
   <listitem>
    <para>
     하나의 마이그레이션 대상을 선택합니다.
    </para>
   </listitem>
   <listitem>
    <para>
     새 리포지토리를 요청하고 활성화합니다.
    </para>
   </listitem>
   <listitem>
    <para>
     마이그레이션을 실행합니다.
    </para>
   </listitem>
  </orderedlist>

  <para>
   마이그레이션 대상 목록은 설치 및 등록한 제품에 따라 다릅니다. 새 SP를 아직 사용할 수 없는 확장을 설치한 경우 마이그레이션 대상이 제공되지 않을 수 있습니다.
  </para>

  <para>
   호스트에서 사용 가능한 마이그레이션 대상 목록은 항상 SUSE 고객 센터에서 검색되며, 설치된 제품 또는 확장에 따라 달라집니다.
  </para>
 </sect1>
 
 <sect1 os="sles;sled" xml:id="sec-upgrade-online-cancel">
  <title>서비스 팩 마이그레이션 취소</title>

  <para>
   서비스 팩 마이그레이션은 마이그레이션 프로세스 중 특정 단계에서만 취소할 수 있습니다.
  </para>

  <orderedlist>
   <listitem>
    <para>
     패키지 업그레이드를 시작하기 전에는 서비스 및 리포지토리로의 변경 등 시스템 변경이 최소화됩니다. <filename>/etc/zypp/repos.d/*</filename>를 복원하여 이전 상태로 돌아갑니다.
    </para>
   </listitem>
   <listitem>
    <para>
     패키지 업그레이드 시작 후에는 스냅퍼 스냅샷을 사용하여 이전 상태로 돌아갈 수 있습니다(<xref linkend="cha-snapper"/> 참조).
    </para>
   </listitem>
   <listitem>
    <para>
     마이그레이션 대상을 선택하면 SUSE 고객 센터에서 리포지토리 데이터를 변경합니다. 이 상태를 수동으로 되돌리려면 <command>SUSEConnect</command>
     <option>--rollback</option>을 사용합니다.
    </para>
   </listitem>
  </orderedlist>
 </sect1>
 
 <sect1 os="sles;sled" xml:id="sec-upgrade-online-yast">
  <title>온라인 마이그레이션 도구(YaST)를 통한 업그레이드</title>

  <para>
   YaST를 사용하여 서비스 팩 마이그레이션을 수행하려면 <guimenu>온라인 마이그레이션</guimenu> 도구를 사용하십시오. 기본적으로 YaST는 타사 리포지토리에서 패키지를 설치하지 않습니다. 타사 리포지토리에서 패키지가 설치된 경우 YaST는 패키지가 SUSE에서 가져오는 동일한 패키지로 바뀌지 않도록 방지합니다.
  </para>

  <note>
   <title>설치 크기 줄이기</title>
   <para>
    서비스 팩 마이그레이션을 수행할 때 YaST는 모든 권장 패키지를 설치합니다. 따라서 특히 사용자 정의 최소 설치의 경우 시스템의 설치 크기가 상당히 증가할 수 있습니다.
   </para>
   <para>
    이 기본 동작을 변경하고 필요한 패키지만 허용하려면 <filename>/etc/zypp/zypp.conf</filename>에서 <option>solver.onlyRequires</option> 옵션을 조정합니다.
   </para>
<screen>solver.onlyRequires = true</screen>
   <para>
    추가적으로, <filename>/etc/zypp/zypper.conf</filename> 파일을 편집하고 <option>installRecommends</option> 옵션을 변경합니다.
   </para>
   <screen>installRecommends=false</screen>
   <para>
    그러면 모든 패키지 작업의 동작이 변경됩니다(예: 패치 또는 새로운 패키지의 설치). 단일 호출을 위한 Zypper의 동작을 변경하려면 <option>--no-recommends</option> 파라미터를 사용합니다.
  </para>
</note>

  <para>
   서비스 팩 마이그레이션을 시작하려면 다음을 수행하십시오.
  </para>

  <procedure xml:id="pro-upgrade-online-yast">
   <step>
    <para>
     향후 종속성 충돌을 방지하기 위해 등록 서버에서 사용되지 않는 확장을 모두 비활성화합니다. 확장을 기억하지 못하는 경우 나중에 YaST는 사용되지 않는 확장 리포지토리를 탐지하여 비활성화합니다.
    </para>
   </step>
   <step>
    <para>
     업데이트할 시스템에서 실행 중인 GNOME 세션에 로그인한 경우 텍스트 콘솔로 전환합니다. GNOME 세션에서 업데이트를 실행하지 않는 것이 좋습니다. 원격 시스템에서 로그인한 경우에는 이 내용이 적용되지 않습니다(GNOME과 함께 VNC 세션을 실행 중인 경우 제외).
    </para>
   </step>
   
   <step>
    <para>
     YaST 온라인 업데이트를 실행하여 시스템을 위한 최신 패키지 업데이트를 받습니다.
    </para>
   </step>
   <step>
    <para>
     패키지 <package>yast2-migration</package> 및 종속 항목을 설치합니다(YaST의 <menuchoice> <guimenu>소프트웨어</guimenu>
     <guimenu>소프트웨어 관리</guimenu> </menuchoice>에서).
    </para>
   </step>
   <step>
    <para>
     YaST를 재시작합니다. 그렇지 않으면 새로 설치한 모듈이 관리 센터에 표시되지 않습니다.
    </para>
   </step>
   <step>
    <para>
     YaST에서 <guimenu>온라인 마이그레이션</guimenu>을 선택합니다(업그레이드할 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>에 따라, 이 모듈은 <guimenu>시스템</guimenu> 또는 <guimenu>소프트웨어</guimenu>로 분류됨). 가능한 마이그레이션 대상 및 요약이 표시됩니다. 시스템에서 마이그레이션 대상을 둘 이상 사용할 수 있는 경우 목록에서 하나를 선택합니다.
    </para>
   </step>
   <step>
    <para>
     목록에서 마이그레이션 대상을 하나 선택하고 <guimenu>다음</guimenu>을 선택하여 계속 진행합니다.
    </para>
   </step>
   <step>
    <para>
     마이그레이션 도구가 업데이트 리포지토리를 제공할 경우 <guimenu>예</guimenu>를 선택하여 진행하는 것이 좋습니다.
    </para>
   </step>
   <step>
    <para>
     <remark>toms 2015-09-09: FATE#319140</remark>
     온라인 마이그레이션 도구가 DVD 또는 로컬 서버에서 구식 리포지토리를 찾는 경우 해당 리포지토리를 비활성화하는 것이 좋습니다. 구식 리포지토리는 이전 서비스 팩용입니다. SUSE Customer Center 또는 RMT의 기존 리포지토리는 자동으로 제거됩니다.
    </para>
    <para>
     등록 서버가 모듈 또는 확장에 대한 마이그레이션을 제공하지 않는 경우 해당 리포지토리 구성은 변경되지 않은 상태로 유지됩니다. 이는 일반적으로 제품 버전 또는 서비스 팩에 한정되지 않은 <guimenu>NVIDIA Compute 모듈</guimenu>과 같은 타사 리포지토리에서 발생합니다. 필요한 경우, 마이그레이션 후 리포지토리 구성을 수동으로 확인할 수 있습니다.
    </para>
   </step>
   <step>
    <para>
     요약을 확인하고 <guimenu>[다음]</guimenu>을 눌러 마이그레이션을 계속합니다. <guimenu>업데이트 시작</guimenu>을 눌러 확인합니다.
    </para>
    <remark>toms 2016-07-13: What to do in case of problems?</remark>
   </step>
   <step>
    <para>
     마이그레이션이 끝나면 시스템을 재시작합니다.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 os="sles;sled" xml:id="sec-upgrade-online-zypper">
  <title>Zypper로 업그레이드</title>

  <para>
   Zypper를 사용하여 서비스 팩 마이그레이션을 수행하려면 패키지 zypper-migration-plugin에서 명령줄 도구 <command>zypper</command> <option>migration</option>을 <package>zypper-migration-plugin</package>.
  </para>

  <note>
   <title>설치 크기 줄이기</title>
   <para>
    서비스 팩 마이그레이션을 수행할 때 YaST는 모든 권장 패키지를 설치합니다. 따라서 특히 사용자 정의 최소 설치의 경우 시스템의 설치 크기가 상당히 증가할 수 있습니다.
   </para>
   <para>
    이 기본 동작을 변경하고 필요한 패키지만 허용하려면 <filename>/etc/zypp/zypp.conf</filename>에서 <option>solver.onlyRequires</option> 옵션을 조정합니다.
   </para>
<screen>solver.onlyRequires = true</screen>
   <para>
    추가적으로, <filename>/etc/zypp/zypper.conf</filename> 파일을 편집하고 <option>installRecommends</option> 옵션을 변경합니다.
   </para>
   <screen>installRecommends=false</screen>
   <para>
    그러면 모든 패키지 작업의 동작이 변경됩니다(예: 패치 또는 새로운 패키지의 설치). 단일 호출을 위한 Zypper의 동작을 변경하려면 <option>--no-recommends</option> 파라미터를 사용합니다.
  </para>
</note>

  <para>
   서비스 팩 마이그레이션을 시작하려면 다음을 수행하십시오.
  </para>

  <procedure xml:id="pro-upgrade-online-zypper">
   <step>
    <para>
     업데이트할 시스템에서 실행 중인 GNOME 세션에 로그인한 경우 텍스트 콘솔로 전환합니다. GNOME 세션에서 업데이트를 실행하지 않는 것이 좋습니다. 원격 시스템에서 로그인한 경우에는 이 내용이 적용되지 않습니다(GNOME과 함께 VNC 세션을 실행 중인 경우 제외).
    </para>
   </step>
   <step>
    <para>
     SUSE Linux Enterprise 시스템을 아직 등록하지 않았다면 지금 등록합니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>SUSEConnect</command> --regcode <replaceable>YOUR_REGISTRATION_CODE</replaceable></screen>
   </step>
   
   <step>
    <para>
     다음과 같이 마이그레이션을 시작합니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>zypper migration</command></screen>
    <para>
     마이그레이션 프로세스에 대한 몇 가지 참고 사항:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       시스템에서 마이그레이션 대상을 둘 이상 사용할 수 있는 경우 목록에서 SP를 하나 선택할 수 있습니다. 이는 하나 이상의 SP를 건너뛰는 것과 같습니다. 기본 제품(SLES, SLED)에 대한 온라인 마이그레이션은 주요 버전의 SP 사이에서만 가능합니다. 
      </para>
     </listitem>
     <listitem>
      <para>
       기본적으로 Zypper는 <command>zypper</command> <option>dup</option>로 전달되는 <option>--no-allow-vendor-change</option> 옵션을 사용합니다. 타사 리포지토리에서 패키지가 설치된 경우 이 옵션은 패키지가 SUSE에서 가져오는 동일한 패키지로 바뀌지 않도록 방지합니다.
      </para>
     </listitem>
     <listitem>
      <para>
       <remark>toms 2015-09-09: FATE#319140</remark>
       Zypper가 DVD 또는 로컬 서버에서 구식 리포지토리를 찾는 경우 해당 리포지토리를 비활성화하는 것이 좋습니다. 이전 SUSE Customer Center 또는 RMT 리포지토리는 자동으로 제거됩니다.
      </para>
     </listitem>
    </itemizedlist>
   </step>
   <step>
    <para>
     모든 변경 사항 특히, 제거될 패키지를 검토합니다. <literal>y</literal>를 입력하여 계속합니다(업그레이드할 정확한 패키지 수는 시스템에 따라 다를 수 있음).
    </para>
<screen>266 packages to upgrade, 54 to downgrade, 17 new, 8 to reinstall, 5 to remove, 1 to change arch.
Overall download size: 285.1 MiB. Already cached: 0 B  After the operation, additional 139.8 MiB will be used.
Continue? [y/n/? shows all options] (y):</screen>
    <para>
     셸에서 스크롤하려면 <keycombo> <keycap function="shift"/> <keycap function="pageup"/>
     </keycombo>    또는 <keycombo> <keycap function="shift"/>
     <keycap function="pagedown"/> </keycombo>    키를 사용합니다.
    </para>
   </step>
   <step>
    <para>
     마이그레이션이 끝나면 시스템을 재시작합니다.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 os="sles;sled" xml:id="sec-upgrade-online-zypper-plain">
  <title>일반 Zypper로 업그레이드</title>

  <para>
   인터넷 또는 등록 서버에 액세스할 수 없어 시스템을 등록하지 못한 경우, YaST 마이그레이션 또는 <command>zypper migration</command>을 사용하여 새 서비스 팩으로 마이그레이션할 수 없습니다. 이러한 경우에도 일반 Zypper 및 몇 가지 수작업을 통해 새 서비스 팩으로 마이그레이션할 수 있습니다.
  </para>

  <important>
   <title>등록되지 않은 시스템만 해당</title>
   <para>
    새 서비스 팩으로의 이 마이그레이션 경로는 인터넷 또는 등록 서버에 액세스할 수 없는 등록되지 않은 시스템<emphasis>만</emphasis> 지원합니다. 예를 들어, 특별하게 보호되는 네트워크 내의 시스템이 이에 해당할 수 있습니다. 등록한 시스템이 있는 경우 YaST 또는 Zypper 마이그레이션을 사용하십시오.
   </para>
  </important>

  <important>
   <title>설치 원본</title>
   <para>
    이 마이그레이션 경로에는 마이그레이션할 시스템에 설치 소스에 대한 액세스가 필요합니다. 예를 들어 RMT 서버 또는 SLP 서버를 설정하여 완료할 수 있습니다.
   </para>
   <para>
    또한, 이 작업에서는 시스템이 설치된 제품 버전을 위한 최신 업데이트 리포지토리에 액세스할 수 있어야 합니다.
   </para>
  </important>

  <procedure>
   <step>
    <para>
     마이그레이션할 시스템에서 실행 중인 그래픽 세션에 로그인한 경우에는 해당 세션에서 로그아웃한 후 텍스트 콘솔로 전환합니다. 그래픽 세션에서 업데이트를 실행하지 않는 것이 좋습니다. 원격 시스템에서 로그인한 경우에는 이 내용이 적용되지 않습니다(X와 함께 VNC 세션을 실행 중인 경우 제외).
    </para>
   </step>
   <step>
    <para>
     이전 SUSE Linux Enterprise 리포지토리를 사용하여 패키지 관리 도구를 업데이트합니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>zypper</command> patch --updatestack-only</screen>
   </step>
   <step>
    <para>
     현재 리포지토리가 할당되지 않은 패키지(독립 패키지)의 목록을 가져옵니다. 이러한 패키지는 마이그레이션되지 않으며 마이그레이션 이후의 작동이 보장되지 않습니다(이유: 사용하는 다른 패키지가 더 이상 호환되지 않는 방식으로 변경될 수 있음). 목록을 가져오려면 다음과 같이 실행합니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper packages --orphaned</screen>
    <para>
     목록을 검토한 후 더 이상 필요하지 않은 모든 독립 패키지를 제거합니다. 남은 모든 독립 패키지를 기록합니다. 이는 나중에 비교하기 위해 필요합니다.
    </para>
   </step>
   <step>
    <para>
     다음을 실행하여 현재 시스템이 등록된 모든 리포지토리 목록을 가져옵니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper repos -u</screen>
    <para>
     제품 버전 번호가 <literal>15-SP6</literal>가 되도록 각 리포지토리 URL을 업데이트하십시오. 예를 들어 리포지토리의 URL이 다음과 같은 경우
    </para>
<screen>http://rmt.example.com/repo/SUSE/Products/SLE-15-SP2-Product-SLES/x86_64/product/</screen>
    <para>
     아래와 같이 변경하십시오.
    </para>
<screen>http://rmt.example.com/repo/SUSE/Products/SLE-15-SP3-Product-SLES/x86_64/product/</screen>
    <para>
     활성화된 모든 리포지토리에서 이 작업을 수행해야 합니다. 현재 비활성화된 리포지토리에서도 이 작업을 수행할 수 있습니다. 그러면 나중에 시스템을 활성화할 때 시스템이 잘못된 설치 소스를 갖는 것이 방지됩니다.
    </para>
    <para>
     리포지토리 URL을 변경하기 위해 제공되는 옵션은 다음과 같습니다.
    </para>
    <substeps>
     <step>
      <para>
       <menuchoice> <guimenu>YaST</guimenu> <guimenu>소프트웨어</guimenu>
       <guimenu>소프트웨어 리포지토리</guimenu></menuchoice> 사용. 리포지토리를 선택하고 <guimenu>편집</guimenu>을 클릭하여 필요한 변경을 수행합니다. 모든 리포지토리에서 이를 수행합니다.
      </para>
     </step>
     <step>
      <para>
       Zypper 사용. 다음과 같이 실행하여 이전 리포지토리를 제거합니다.
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper removerepo <replaceable>OLD_REPO_ID</replaceable></screen>
      <para>
       그런 다음, 다음과 같이 실행하여 해당되는 새 리포지토리를 추가합니다.
      </para>
<screen> <prompt>&gt; </prompt><command>sudo</command> zypper addrepo -f <replaceable>URL</replaceable> <replaceable>NAME</replaceable>-15-SP6</screen>
     </step>
     <step>
      <para>
       <filename>/etc/zypp/repos.d</filename>에서 리포지토리 구성 파일 편집. 각 리포지토리는 1개의 구성 파일로 표시됩니다. 각 파일에서 <literal>baseurl</literal> 파라미터 값을 변경해야 합니다.
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     <command>zypper repos -u</command>를 실행하여 변경 사항을 확인한 후 다음을 실행하여 리포지토리를 업데이트합니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper refresh -f -s</screen>
    <para>
     리포지토리 업데이트가 실패하는 경우, URL을 잘못 입력하지 않았는지 다시 확인합니다. 문제를 수정할 수 없는 경우에는 실패한 리포지토리를 비활성화하는 것이 좋습니다.
    </para>
    <para>
     모든 리포지토리가 올바르게 구성된 경우에는 다음을
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper refresh -f -s</screen>
    <para>
     다시 실행하여 <emphasis>모든</emphasis> 리포지토리가 최신 상태가 되도록 합니다.
    </para>
   </step>
   <step>
    <para>
     마이그레이션을 시작하기 전에 우선 테스트 실행을 하는 것이 좋습니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper dup -D --no-allow-vendor-change --no-recommends</screen>
    <para>
     <option>-D</option> 파라미터는 시스템을 실제로 변경하지 않고 마이그레이션을 시뮬레이션하는 모의 연습을 수행합니다. 문제가 발생하면 수정한 후 계속 진행합니다. 시험 실행이 성공하는 경우:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper dup --no-allow-vendor-change --no-recommends</screen>
    <para>
     <option>-no-allow-vendor-change</option>는 타사 RPM이 기본 시스템의 RPM을 덮어쓰지 않도록 합니다. <option>--no-recommends</option> 옵션은 초기 설치 중 선택 취소된 패키지가 다시 추가되지 않도록 합니다.
    </para>
   </step>
   <step>
    <para>
     마이그레이션이 완료되고 시스템이 새 서비스 팩 버전으로 부팅되면 독립 패키지 확인을 다시 실행합니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper packages --orphaned</screen>
    <para>
     마이그레이션을 시작하기 전 작성한 목록과 새 목록을 비교합니다. 새 패키지가 목록에 표시되는 경우 새 서비스 팩의 다른 모듈로 이동했기 때문일 수 있습니다. 이전 설치에 해당 모듈이 없는 경우 패키지가 업데이트되지 않습니다.
    </para>
    <para>
     <link xlink:href="https://scc.suse.com/packages"/>에서 패키지가 속한 모듈을 확인할 수 있습니다. <command>zypper addrepo</command> 또는 YaST 소프트웨어 리포지토리 모듈을 사용하여 누락된 모듈을 추가하고 다음을 실행하여 이후에 해당하는 독립 패키지를 업데이트합니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper install --no-recommends <replaceable>LIST OF PACKAGES</replaceable></screen>
   </step>
   <step>
    <para>
     새 서비스 팩으로 마이그레이션되었습니다!
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 os="sles;sled" xml:id="sec-upgrade-online-rollback">
  <title>서비스 팩 롤백</title>

  <para>
   서비스 팩이 작동하지 않을 경우 SUSE Linux Enterprise에서는 서비스 팩 마이그레이션이 시작되기 이전 상태로 시스템을 되돌릴 수 있습니다. 이를 위해서는 스냅샷을 활성화한 Btrfs 루트 파티션(SLES 12 이후부터 기본값)이 필요합니다. 자세한 내용은 <xref linkend="cha-snapper"/>에서 참조하십시오.
  </para>

  <procedure xml:id="pro-upgrade-online-rollback">
   <step>
    <para>
     모든 스냅퍼 스냅샷 목록을 가져옵니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> snapper list</screen>
    <para>
     출력을 검토하여 서비스 팩 마이그레이션이 시작되기 직전에 생성된 스냅샷을 찾습니다. <guimenu>설명</guimenu> 열에 해당하는 설명이 포함되어 있고 스냅샷은 <guimenu>사용자 데이터</guimenu> 열에서 <literal>important</literal>로 표시되어 있습니다. <guimenu>#</guimenu> 열의 스냅샷 번호와 <guimenu>날짜</guimenu> 열의 날짜를 기록해 둡니다.
    </para>
   </step>
   <step>
    <para>
     시스템을 재부팅합니다. 부팅 메뉴에서 <guimenu>읽기 전용 스냅샷에서 부트 로더 시작</guimenu>을 선택하고 이전 단계에서 기록해 둔 날짜와 번호의 스냅샷을 선택합니다. 두 번째 부팅 메뉴(스냅샷의 메뉴)가 로드됩니다. SLES <phrase role="productnumber"><phrase os="sles;sled">15 SP6</phrase></phrase>로 시작하는 항목을 선택하여 부팅합니다.
    </para>
   </step>
   <step>
    <para>
     시스템이 시스템 파티션이 읽기 전용으로 탑재된 이전 상태로 부팅됩니다. <systemitem class="username">root</systemitem>로 로그인하고 올바른 스냅샷을 선택했는지 확인합니다. 모든 기능이 제대로 작동하는지도 확인합니다. 루트 파일 시스템은 읽기 전용으로 탑재되므로 기능에 제한이 있을 수 있습니다.
    </para>
    <para>
     문제가 발생하거나 잘못된 스냅샷을 부팅한 경우 재부팅하고 다른 스냅샷을 선택하여 부팅합니다. 이때까지는 영구적으로 변경되지 않았습니다. 스냅샷이 올바르고 제대로 작동하는 경우 다음 명령을 실행하여 영구적으로 변경합니다.
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> snapper rollback</screen>
    <para>
     시스템을 재부팅합니다. 부팅 화면에서 기본 부팅 항목을 선택하여 복구된 시스템으로 재부팅합니다.
    </para>
   </step>
   <step>
    <para>
     리포지토리 구성이 제대로 재설정되었는지 확인합니다. 또한 모든 제품이 올바로 등록되었는지 확인합니다. 하나라도 잘못된 경우 나중에 시스템을 업데이트할 수 없거나 시스템이 잘못된 패키지 리포지토리를 사용하여 업데이트될 수 있습니다.
    </para>
    <para>
     이 절차를 시작하기 전에 인터넷에 액세스할 수 있는지 확인하십시오.
    </para>
    <substeps>
     <step>
      <para>
       다음을 실행하여 서비스 및 리포지토리를 새로 고칩니다.
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper ref -fs</screen>
     </step>
     <step>
      <para>
       다음을 실행하여 활성 리포지토리 목록을 가져옵니다.
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper lr</screen>
      <para>
       이 명령을 출력을 자세히 확인하십시오. 업데이트를 위해 추가된 서비스와 리포지토리가 나열되지 않아야 합니다. 예를 들어, SLES <phrase role="productnumber"><phrase os="sles;sled">15 SP6</phrase></phrase>에서 SLES 15 GA로 롤백하는 경우 목록은 <literal>SLES15-SP6</literal> 리포지토리가 아닌 <literal>SLES15-GA</literal> 리포지토리를 포함해야 합니다.
      </para>
      <para>
       잘못된 리포지토리가 나열되는 경우 이를 삭제하고 필요한 경우 사용 중인 제품 또는 서비스 팩 버전과 일치하는 버전으로 바꾸어야 합니다. 지원되는 마이그레이션 경로에 대한 리포지토리 목록은 <xref linkend="sec-upgrade-background-modules"/>을 참조하십시오. (수작업이 필요할 수 있음에 유의하십시오. 리포지토리는 자동으로 업데이트되지만, 확인하고 필요한 수정을 하는 것이 좋습니다.)
      </para>
     </step>
     <step>
      <para>
       마지막으로 다음을 실행하여 설치한 모든 제품의 등록 상태를 확인합니다.
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> SUSEConnect --status</screen>
      <para>
       모든 제품이 <literal>Registered</literal>으로 보고되어야 합니다. 그렇지 않으면 다음을 실행하여 등록을 복구합니다.
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> SUSEConnect --rollback</screen>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   이제 시스템을 서비스 팩 마이그레이션이 시작되기 직전에 캡처된 상태로 되돌렸습니다.
  </para>
 </sect1>
 <sect1 os="sles;sled" xml:id="sec-upgrade-online-manager">
  <title>SUSE Manager를 사용하여 업그레이드</title>

  <para>
   SUSE Manager는 SUSE Linux Enterprise 클라이언트용 업데이트, 패치 및 보안 수정을 제공하기 위한 서버 솔루션입니다. 이 솔루션에는 관리 작업 도구 세트와 웹 기반 사용자 인터페이스가 함께 제공됩니다. SUSE Manager에 대한 자세한 내용은 <link xlink:href="https://www.suse.com/products/suse-manager/"/>를 참조하십시오.
  </para>

  <para>
   SP 마이그레이션을 사용하면 주 버전 내에서 다른 서비스 팩으로 마이그레이션할 수 있습니다(예: SLES 15 GA에서 SLES 15 SP6로).
  </para>

  
  <para>
  SUSE Manager가 시스템을 관리하는 경우에는 SUSE Manager 설명서의 설명과 같이 업데이트합니다. <citetitle>Client Migration</citetitle> 절차에 대한 설명은 <link xlink:href="https://documentation.suse.com/suma/"/>의 <citetitle>SUSE Manager Upgrade Guide</citetitle>에서 제공됩니다.
 </para>
 </sect1>
 <sect1 xml:id="sec-upgrade-online-leap-to-sle" os="sles">
  <title>openSUSE Leap에서 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로 업그레이드</title>
  <para>
   openSUSE Leap 설치를 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로 업그레이드할 수 있습니다. 마이그레이션을 위해 어떤 Leap 버전이 지원되는지 알아보려면 <xref linkend="sec-upgrade-paths-supported"/>를 참조하십시오.
  </para>
  <remark>
   cwickert 2012-02-25: For openSUSE Leap 15.3 and SLE 15 SP3, removing packages
   should not be necessary; everything should be provided through Package Hub.
   For SP2 and earlier however, orphaned packages should be removed.
  </remark>
  <warning>
   <title>openSUSE 패키지를 전부 마이그레이션할 수는 없음</title>
   <para>
    openSUSE는 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>보다 더 많은 패키지를 제공합니다. 추가 패키지는 대부분 SUSE Package Hub를 통해 제공되고 마이그레이션됩니다. SUSE Package Hub를 통해 제공되지 않는 추가 패키지는 마이그레이션 후 업데이트를 더 이상 수신하지 않으므로 이후 제거해야 합니다.
   </para>
   <para>
    시스템 운영에 필요한 모든 패키지를 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 및 SUSE Package Hub 리포지토리에서 제공하는지 확인하십시오. SUSE Package Hub에 대한 자세한 내용은 <link xlink:href="https://packagehub.suse.com/"/>를 참조하십시오.
   </para>
  </warning>

  <sect2 xml:id="sle-upgrade-online-leap-to-sle-yast-migration">
   <title><command>yast2 migration</command>을 사용한 업그레이드</title>
   <para>
    다음 절차는 <xref linkend="sec-upgrade-online-yast"/>와 유사하지만 몇 가지 추가 단계가 필요합니다. 운영 시스템에서 이 프로시저를 실행하기 전, 운영 설정을 복제한 테스트 시스템에서 우선 실행해 보는 것이 좋습니다.
   </para>
   <procedure xml:id="pro-upgrade-online-leap-to-sle">
    <title><command>yast2 migration</command>을 사용하여 openSUSE Leap을 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로 업그레이드</title>
    <para>
     openSUSE Leap에서 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로 마이그레이션하려면 다음 단계를 수행합니다.
    </para>
    <step>
     <para>
      사용하지 않는 모든 응용 프로그램을 닫고 TTY로 전환합니다(예를 들어, <keycombo><keycap function="control"/>
      <keycap function="alt"/><keycap>F1</keycap></keycombo> 누르기). 그런 다음 <systemitem class="username">root</systemitem>로 로그인합니다.
     </para>
    </step>
    <step>
     <para>
      <package>yast2-migration</package> 및 <package>rollback-helper</package> 패키지를 설치합니다.
     </para>
<screen><prompt role="root"># </prompt><command>zypper in yast2-migration rollback-helper</command></screen>
    </step>
    <step>
     <para>
      다음과 같이 <systemitem class="service">rollback-helper</systemitem> 서비스를 활성화합니다.
     </para>
<screen><prompt role="root"># </prompt><command>systemctl enable rollback</command></screen>
    </step>
    <step>
     <para>
      다음과 같이 시스템을 SUSE Customer Center에 등록합니다.
     </para>
<screen><prompt role="root"># </prompt><command>yast2 registration</command></screen>
    </step>
    <step>
     <para>
      다음과 같이 마이그레이션을 수행합니다.
     </para>
<screen><prompt role="root"># </prompt><command>yast2 migration</command></screen>
     <para>
      패키지가 충돌하는 경우 YaST는 선택할 수 있도록 확인 목록을 표시합니다.
     </para>
    </step>
    <step>
     <para>
      시스템을 재부팅합니다:
     </para>
<screen><prompt role="root"># </prompt><command>reboot</command></screen>
    </step>
   </procedure>
   <para>
    이제 시스템을 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로 마이그레이션하는 작업이 성공적으로 완료되었습니다. <xref linkend="cha-upgrade-finish"/>를 진행하고 독립 패키지를 제거하여 완전하게 지원되는 SUSE Linux Enterprise 설치를 실행 중인지 확인합니다.
   </para>
   <para>
    마이그레이션 후 문제가 발생하면 서비스 팩 업그레이드 같은 마이그레이션을 되돌릴 수 있습니다. 지시사항은 <xref linkend="sec-upgrade-online-rollback"/>을 참조하십시오.
   </para>
  </sect2>

  <sect2 xml:id="sle-upgrade-online-leap-to-sle-yast-migration-sle">
   <title><command>yast2 migration_sle</command>를 사용한 업그레이드</title>
   <para>
    openSUSE Leap에서 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로의 간소화된 마이그레이션은 Leap 15.4부터 기술 미리 보기로 제공됩니다.
   </para>
   <procedure>
    <title><command>yast2 migration_sle</command>를 사용하여 openSUSE Leap을 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로 업그레이드</title>
    <para>
     openSUSE Leap에서 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로 마이그레이션하려면 다음 단계를 수행합니다.
    </para>
    <step>
     <para>
      사용하지 않는 모든 응용 프로그램을 닫습니다(권장).
     </para>
    </step>
    <step>
     <para>
      <package>yast2-migration-sle</package> 및 <package>rollback-helper</package> 패키지를 설치합니다.
     </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>zypper in yast2-migration-sle rollback-helper</command></screen>
    </step>
    <step>
     <para>
      다음과 같이 <systemitem class="service">rollback-helper</systemitem> 서비스를 활성화합니다.
     </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>systemctl enable rollback</command></screen>
    </step>
    <step>
     <para>
      YaST를 열고 <menuchoice><guimenu>소프트웨어</guimenu>
       <guimenu>온라인 마이그레이션</guimenu></menuchoice>을 선택하거나 다음을 실행합니다.
     </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>yast2 migration_sle</command></screen>
     <para>
      마법사가 마이그레이션 프로세스를 안내합니다. 보류 중인 업데이트가 있는 경우 시스템을 등록하기 전에 설치할 수 있습니다. 등록하려면 등록 코드와 전자 메일 주소를 입력합니다. 로컬 RMT 서버에 등록하려면 등록 코드 대신 해당 URL을 입력하고 전자 메일 주소를 비워 둡니다.
     </para>
     <para>
      시스템이 등록되면 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 리포지토리가 추가되고 SLE 패키지가 설치되어 openSUSE 패키지를 대체합니다.
     </para>
    </step>
    <step>
     <para>
      시스템을 재부팅합니다:
     </para>
     <screen><prompt>&gt; </prompt><command>sudo</command> <command>reboot</command></screen>
    </step>
   </procedure>
   <para>
    이제 시스템을 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>로 마이그레이션하는 작업이 성공적으로 완료되었습니다. <xref linkend="cha-upgrade-finish"/>를 진행하고 독립 패키지를 제거하여 완전하게 지원되는 SUSE Linux Enterprise 설치를 실행 중인지 확인합니다.
   </para>
   <para>
    마이그레이션 후 문제가 발생하면 서비스 팩 업그레이드 같은 마이그레이션을 되돌릴 수 있습니다. 지시사항은 <xref linkend="sec-upgrade-online-rollback"/>을 참조하십시오.
   </para>
  </sect2>
 </sect1>
</chapter>
